const enTranslations = {
  // Navigation
  'home': 'HOME',
  'about': 'ABOUT',
  'cooperation': 'COOPERATION',
  'contact': 'CONTACT',

  // Home page
  'content-intro': 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, quos.',
  'features-title': 'Why Choose Take Box?',
  'features-detail-1': 'Active 24/7, no need for staff',
  'features-detail-2': 'Save operating costs',
  'features-detail-3': 'Easy to manage and maintain',
  'features-detail-4': 'User-friendly interface',
  'features-detail-5': 'Support multiple payment methods',
  'features-detail-6': 'Detailed revenue reports',
  'partners-title': 'Our Partners',
  // About page
  // 'about_us': 'About Us',
  'about-content':'We are established in 2017, our head office is located at 92 Nguyen Huu Canh, Ward 22, Binh Thanh District, Ho Chi Minh City. Our company is specializing in vending machines. ',
  'vision':'Our Vision',
  'vision-content':'Vending machine is a great invention of the 1980s and being so popular in all developed countries such as Japan, Korea, China, Malaysia, etc. We wish to expand the popularity of vending machines to serve Vietnamese people and improve a modern Vietnamese image.',
  'more-info-title':'VENDING MACHINE',
  'more-info-content':'The vending machines have many utilities to better serve human life. Vending machines can operate 24 hours a day which consumers can serve themselves at any time. It can help to save processing time, fulfill consumers needs and ensure safety & health for consumers. Moreover, vending machine can save space and human resources for operating sales to serve consumers.Take Box is committed to providing machine products with clear origin and ensuring food hygiene and safety. Soft drinks are kept at a stable temperature to be sure they are stored in a good condition. In addition, consumers have a variety of choices for themselves such as drinks with different types and brands, snacks, candies at affordable prices.',
  // Cooperation page
  'partnership': 'PARTNERSHIP',
  'partnership-text': 'The essence of Take Box is always base on user needs, integrate arious resources from different industries to provide users with quality services. Through innovation, intelligent operation, deep understanding of the market, we provide valuable services to our customers.',
  'become-a-location': 'BECOME A LOCATION',
  'become-a-location-text': 'Install vending machine in your place and become a Take Box location',
  'advertisment': 'ADVERTISMENT',
  'advertisment-text': 'Take Box commits to help advertisers reach their target accurately',
  'lease-and-franchise':'LEASE & FRANCHISE',
  'lease-and-franchise-text':'Become a Take Box partners and develop the new generation of business',
  'promotion': 'PRODUCT PROMOTION',
  'promotion-text': 'Introduce new drinks, snack and food in Take Box machine',
  'read-more':'Read More',
  // Footer
  'follow_us': 'Follow Us',
  'privacy_policy': 'Privacy Policy',
  'terms_conditions': 'Terms & Conditions'
}; 

const viTranslations = {
  // Navigation
  'home': 'TRANG CHỦ',
  'about': 'GIỚI THIỆU',
  'cooperation': 'HỢP TÁC',
  'contact': 'LIÊN HỆ',

  // Home page
  'content-intro': 'Máy bán hàng tự động cao cấp tại Việt Nam dành cho bạn. Máy bán hàng tự động đã trở thành thiết bị phổ biến ở các nước và khu vực phát triển vì sự thuận tiện, tiên tiến, văn mình và hoạt động cả ngày lẫn đêm của nó.',
  'features-title': 'Tại sao lại chọn Take Box?',
  'features-detail-1': 'Hoạt động 24/7, không cần nhân viên',
  'features-detail-2': 'Tiết kiệm chi phí vận hành',
  'features-detail-3': 'Dễ dàng quản lý và bảo trì',
  'features-detail-4': 'Giao diện thân thiện với người dùng',
  'features-detail-5': 'Hỗ trợ nhiều phương thức thanh toán',
  'features-detail-6': 'Báo cáo doanh thu chi tiết',
  'partners-title': 'Đối tác của chúng tôi',
  // About page
  // 'about_us': 'Về chúng tôi',
  'about-content':'Take Box được thành lập năm 2017, được tọa lạc tại văn phòng chính địa chỉ 92 Nguyễn Hữu Cảnh, Phường 22, Quận Bình Thạnh, TPHCM. Chúng tôi chuyên cung cấp máy bán hàng tự động.',
  'vision':'Tầm nhìn',
  'vision-content':'Máy bán hàng tự động là một phát minh tuyệt vời vào năm 1980 và đang dần phổ biến ở các nước phát triển như Nhật Bản, Hàn Quốc, Trung Quốc, Malaysia, …vv. Chúng tôi hy vọng sẽ mở rộng và phục vụ máy này tại thị trường Việt nam cho người Việt Nam, và góp phần xây dựng hình ảnh hiện đại đô thị.',
  'more-info-title':'Máy bán hàng tự động',
  'more-info-content':'Máy bán hàng tự động có rất nhiều tiện ích cho con người. máy hoạt động 24h trong ngày, điều đó giúp cho khách hàng có thể sử dụng bất cứ lúc nào. Bên cạnh đó giúp tiết kiệm thời gian cho khách hàng cũng như là đáp ứng đúng nhu cầu của khách với đảm bảo tốt về chất lượng và sức khỏe. Mặt khác, máy bán hàng tự động tiết kiệm không gian và không cần nhân lực để phục vụ quý khách.Chúng tôi cam kết cung cấp máy từ nguồn góc rõ ràng và đảm bảo thức ăn đồ uống vệ sinh và an toàn. Đồ uống được giữ ở một nhiệt độ ổn định và môi trường điều kiện tốt. khách hàng có nhiều sự lựa chọn về đồ ăn thức uống như thương hiệu, nhãn hiệu, giá…',
   // Cooperation page
   'partnership': 'HỢP TÁC',
   'partnership-text': 'Take box luôn phục vụ dựa trên nhu cầu của khách hàng, tích hợp các nguồn lực khác nhau từ các ngành công nghiệp riêng biệt để cung cấp cho khách hàng với dịch vụ tốt nhất. Thông qua sự cải tiến, sự vận hành thông minh, am hiểu về thị trường, chúng tôi cung cấp dịch vụ giá trị cho khách hàng.',
   'become-a-location': 'TRỞ THÀNH ĐỊA ĐIỂM ĐẶT',
   'become-a-location-text': 'Lắp đặt máy bán hàng tự động tại chỗ của bạn và trở thành địa điểm của Take Box.',
   'advertisment': 'QUẢNG CÁO',
   'advertisment-text': 'Take box cam kết hỗ trợ đối tác tiếp cận được mục tiêu đối tượng chính xác.',
   'lease-and-franchise':'THUÊ VÀ NHƯỢNG QUYỀN',
   'lease-and-franchise-text':'Trở thành đối tác của Take Box và phát triển một lối kinh doanh mới',
   'promotion': 'XÚC TIẾN SẢN PHẨM',
   'promotion-text': 'Giới thiệu đồ ăn thức uống mới thông qua Take box.',
   'read-more':'Đọc thêm',

  // Footer
  'follow_us': 'Theo dõi chúng tôi',
  'privacy_policy': 'Chính sách bảo mật',
  'terms_conditions': 'Điều khoản và điều kiện'
}; 

// Lấy ngôn ngữ từ localStorage hoặc mặc định là 'vi'
let currentLang = localStorage.getItem("language") || "vi";

// Hàm chuyển đổi ngôn ngữ
function changeLanguage(lang) {
  currentLang = lang;
  localStorage.setItem("language", lang);
  updateContent();
  updateLanguageButton();
}

// Hàm cập nhật nội dung theo ngôn ngữ
function updateContent() {
  const translations = currentLang === "vi" ? viTranslations : enTranslations;

  document.querySelectorAll("[data-translate]").forEach((element) => {
    const key = element.getAttribute("data-translate");
    if (translations[key]) {
      element.textContent = translations[key];
    }
  });
}

// Hàm cập nhật nút ngôn ngữ
function updateLanguageButton() {
  const button = document.getElementById("languageDropdown");
  if (!button) return; // Thoát nếu không tìm thấy nút

  const flag = button.querySelector("img");
  if (!flag) return; // Thoát nếu không tìm thấy hình ảnh

  // Sử dụng đường dẫn tuyệt đối
  const imgPath = "/img/";

  if (currentLang === "vi") {
    flag.src = imgPath + "vn-flag.png";
    flag.alt = "VN";
  } else {
    flag.src = imgPath + "en-flag.png";
    flag.alt = "EN";
  }
}

// Khởi tạo nội dung khi trang được load
document.addEventListener("DOMContentLoaded", () => {
  updateContent();
  updateLanguageButton();
});

// Function to check if element is in viewport
function isInViewport(element) {
  const rect = element.getBoundingClientRect();
  return (
    rect.top >= 0 &&
    rect.left >= 0 &&
    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
  );
}

// Function to handle scroll animation
function handleScrollAnimation() {
  const elements = document.querySelectorAll('.fade-in-left, .fade-in-right, .fade-in-up');
  
  elements.forEach(element => {
    if (isInViewport(element)) {
      element.classList.add('animate');
    }
  });
}

// Add scroll event listener
window.addEventListener('scroll', handleScrollAnimation);
// Check on initial load
window.addEventListener('load', handleScrollAnimation);

// Function to include HTML components
async function includeHTML(elementId, path) {
  try {
    const response = await fetch(path);
    const html = await response.text();
    document.getElementById(elementId).innerHTML = html;
    
    // Initialize language after loading navbar
    if (elementId === 'navbar-container') {
      const currentLang = localStorage.getItem('language') || 'vi';
      changeLanguage(currentLang);
    }
    return true;
  } catch (error) {
    console.error('Error loading component:', error);
    return false;
  }
}

// Load navbar and footer
document.addEventListener('DOMContentLoaded', function() {
    // Load navbar
    fetch('../pages/navbar.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('navbar-container').innerHTML = data;
            // Initialize language after loading navbar
            const currentLang = localStorage.getItem('language') || 'vi';
            changeLanguage(currentLang);
            // Set active nav link immediately after navbar is loaded
            setActiveNavLink();
        })
        .catch(error => console.error('Error loading navbar:', error));

    // Load footer
    fetch('../pages/footer.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer-container').innerHTML = data;
        })
        .catch(error => console.error('Error loading footer:', error));
});

// Add active class to current page link
function setActiveNavLink() {
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    const navLinks = document.querySelectorAll('.nav-link');
    
    navLinks.forEach(link => {
        // Remove any existing active styles
        link.classList.remove('active');
        link.style.borderTop = 'none';
        
        // Get the href value and extract the page name
        const href = link.getAttribute('href');
        const pageName = href.split('/').pop();
        
        // Check if this is the current page
        if (pageName === currentPage || 
            (currentPage === '' && pageName === 'index.html') ||
            (currentPage === 'index.html' && pageName === 'index.html')) {
            link.classList.add('active');
            link.style.borderTop = '3px solid var(--primary-color)';
        }
    });
}

// Also call setActiveNavLink when URL changes
window.addEventListener('popstate', setActiveNavLink);